{% extends "base.html" %}
{% load humanize %}
{% load static %}

{% block content %}
<!-- Contenido específico de la página de dashboard -->
<div class="content-header">
</div>
<div class="content">
  <div class="container-fluid">
    <div class="row mb-2">
      <div class="col-sm-6">
        <h3 class="m-0">Fichas Medicas</h3>
      </div>
      <div class="col-sm-6">
        <ol class="breadcrumb float-sm-right">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <li class="breadcrumb-item active">Dashboard</li>
        </ol>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-12">
        <!-- Pestañas (Tabs) -->
        <div class="card">
          <div class="card-header p-0">
            <ul class="nav nav-pills">
              <li class="nav-item">
                <a class="nav-link" id="tabSeleccion" data-toggle="pill" href="#seleccion"
                  onclick="volverASeleccion()">Seleccionar opciones</a>

              </li>
              <li class="nav-item">
                <a class="nav-link" id="tabTabla" data-toggle="pill" href="#miTabla">Tabla</a>
              </li>
            </ul>
          </div>
          <div class="card-body">
            <div class="tab-content">
              <!-- Contenido de la pestaña de selección -->
              <div id="seleccion" class="tab-pane fade show active">
                <label for="opcionesSelect">Selecciona una opción:</label>
                <select class="form-control select2 form-control-sm" style="width: 100%;" id="codigo_paciente"
                  name="codigo_paciente">
                  <option value="">Buscar Paciente</option>
                  {% for item in data %}
                  <option value="{{ item.codprovcli }}">{{ item.codprovcli }} - {{ item.nombre }}</option>
                  {% endfor %}
                </select>

                <button type="button" class="btn btn-primary mt-2" onclick="seleccionarOpcion()">Continuar</button>
              </div>

              <!-- Contenido de la pestaña de la tabla -->
              <div id="miTabla" class="tab-pane fade">
                <!-- Contenido de la tabla -->
                <div class="table-responsive">

                  <table class="table">
                    <thead>
                      <tr>
                        <th class="text-sm">Ficha</th>
                        <th class="text-sm">Cedula</th>
                        <th class="text-sm">Historia</th>
                        <th class="text-sm">Paciente</th>
                        <th class="text-sm">Dirección</th>
                        <th class="text-sm">Teléfono</th>
                        <th class="text-sm">Acciones</th>
                        <!-- Agrega más columnas según sea necesario -->
                      </tr>
                    </thead>
                    <tbody>

                    </tbody>
                  </table>
                </div>
                <!-- /.table -->
              </div>
            </div>
          </div>
        </div>
        <!-- Fin de Pestañas (Tabs) -->
      </div>
    </div>

    <!-- MODAL PRINCIPAL -->
    <div class="modal fade" data-backdrop="static" id="modalInfoPaciente" tabindex="-1" role="dialog"
      aria-labelledby="modalInfoPacienteLabel" aria-hidden="true">
      <div class="modal-dialog modal-xl" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="modalInfoPacienteLabel">Detalles del Paciente</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <!-- BARRA DE NAVEGACION DE PASOS Y FORMULARIO DE INFORMACION PRINCIPAL -->
            <div class="row g-1">
              <div class="col-md-12">

                <!-- Barra de navegación -->
                <ul class="nav nav-pills">
                  <li class="nav-item">
                    <a class="nav-link active paso-tab" data-toggle="pill" href="#paso1">Personal</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link paso-tab" data-toggle="pill" href="#paso2" disabled>Dosis</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link paso-tab" data-toggle="pill" href="#paso3" disabled>Paso 3</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link paso-tab" data-toggle="pill" href="#paso4" disabled>Paso 4</a>
                  </li>
                </ul>

                <!-- CONTENIDO DEL FORMULARIO DE INFORMACION PERSONAL -->
                <div class="tab-content mt-2">
                  <!-- Paso 1 DATOS PERSONALES CARGADOS DESDE EL API -->
                  <div class="tab-pane fade show active" id="paso1">
                    <br>
                    <form id="datosEmpresaForm" method="get" action="{% url 'tu_vista_de_impresion' %}">
                      {% csrf_token %}
                      <div class="card card-primary">
                        <div class="card-header">
                          <h4 class="card-title">Datos del establecimiento - Empresa y Usuario</h4>
                        </div>
                        <div class="card-body">
                          <div class="row g-1">
                            <div class="col-md-12">
                              <div class="form-group">
                                <label for="inputNombreEmpresaVacuna">Intitución del Sistema o Nombre de la
                                  Empresa</label>
                                <input type="text" class="form-control" id="inputNombreEmpresaVacuna" name="empresa"
                                  disabled>
                              </div>
                            </div>
                          </div>
                          <div class="row g-1">
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputRucVacuna">RUC</label>
                                <input type="text" class="form-control" id="inputRucVacuna" name="ruc" disabled>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputCiuuVacuna">CIUU</label>
                                <input type="text" class="form-control" id="inputCiuuVacuna" name="ciuu" disabled>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <label for="inputEstablecimientoVacuna">Establecimiento de Salud</label>
                                <input type="text" class="form-control" id="inputEstablecimientoVacuna"
                                  name="establecimientosalud" disabled>
                              </div>
                            </div>
                          </div>
                          <div class="row g-1">
                            <div class="col-md-6">
                              <div class="form-group">
                                <label for="inputNumHistoriaClinicaVacuna">Número de Historia Clínica</label>
                                <input type="number" class="form-control" id="inputNumHistoriaClinicaVacuna"
                                  name="historiaclinica" disabled>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <label for="inputNumArchivoVacuna">Número de Archivo</label>
                                <input type="number" class="form-control" id="inputNumArchivoVacuna" name="numarchivo"
                                  disabled>
                              </div>
                            </div>
                          </div>
                          <div class="row g-1">
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputPrimerApellidoVacuna">Primer Apellido</label>
                                <input type="text" class="form-control" id="inputPrimerApellidoVacuna"
                                  name="pmerapellido" disabled>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputSegundoApellidoVacuna">Segundo Apellido</label>
                                <input type="text" class="form-control" id="inputSegundoApellidoVacuna"
                                  name="segapellido" disabled>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputPrimerNombreVacuna">Primer Nombre</label>
                                <input type="text" class="form-control" id="inputPrimerNombreVacuna" name="pmernombre"
                                  disabled>
                              </div>
                            </div>
                            <div class="col-md-3">
                              <div class="form-group">
                                <label for="inputSegundoNombreVacuna">Segundo Nombre</label>
                                <input type="text" class="form-control" id="inputSegundoNombreVacuna" name="segnombre"
                                  disabled>
                              </div>
                            </div>
                          </div>
                          <div class="row g-1">
                            <div class="col-md-6">
                              <div class="form-group">
                                <label for="inputSexoVacuna">Sexo</label>
                                <input type="text" class="form-control" id="inputSexoVacuna" name="sexo" disabled>
                              </div>
                            </div>
                            <div class="col-md-6">
                              <div class="form-group">
                                <label for="inputCargoOcupacionVacuna">Cargo/Ocupación</label>
                                <input type="text" class="form-control" id="inputCargoOcupacionVacuna" name="ocupacion"
                                  disabled>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <button type="button" class="btn btn-primary next-button" data-toggle="pill"
                        href="#paso2">Siguiente</button>
                    </form>
                  </div>
                  <!-- Paso 2 -->
                  <div class="tab-pane fade" id="paso2">
                    <br>
                    <div class="card card-primary">
                      <div class="card-header">
                        <h4 class="card-title">Inmunizaciones</h4>
                      </div>
                      <div class="card-body">
                        <!-- LISTA DE VACUNAS -->
                        <div class="accordion" id="accordionListInmunizaciones">
                          <div class="card">
                            <div class="card-header" id="tetanosDifteriaItem">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left" type="button" data-toggle="collapse"
                                  data-target="#coleccionTetanos" aria-expanded="true" aria-controls="coleccionTetanos">
                                  Tetanos - Difteria
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionTetanos" class="collapse show" aria-labelledby="tetanosDifteriaItem"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">

                                <!-- CONTENIDO CON UN FORMULARIO -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableTetanos">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRow">
                                        <td><button class="btn btn-success" id="btnAgregarFilaTetanos"
                                            onclick="agregarFila()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpan">1</span></td>
                                        <td><input type="date" id="fechaInput" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInput" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInput" placeholder="Esquema"></td>
                                        <td><input type="text" id="responsableInput" placeholder="Responsable"></td>
                                        <td><input type="text" id="establecimientoInput" placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInput" placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="hepatitisA">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionHepatitisA" aria-expanded="false"
                                  aria-controls="coleccionHepatitisA">
                                  Hepatitis A
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionHepatitisA" class="collapse" aria-labelledby="hepatitisA"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- CONTENIDO DE FORMULARIO PARA HEPATITIS A -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableHepatitisA">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowHepatitis">
                                        <td><button class="btn btn-success" id="btnAgregarFilaHepatitis"
                                            onclick="agregarFilaHepatitis()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpanHepatitis">1</span></td>
                                        <td><input type="date" id="fechaInputHepatitis" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInputHepatitis" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInputHepatitis" placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputHepatitis" placeholder="Responsable">
                                        </td>
                                        <td><input type="text" id="establecimientoInputHepatitis"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputHepatitis"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="hepatitisB">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionHepatitisB" aria-expanded="false"
                                  aria-controls="coleccionHepatitisB">
                                  Hepatitis B
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionHepatitisB" class="collapse" aria-labelledby="hepatitisB"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- TABLA HEPATITIS B -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableHepatitisB">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowHepatitisB">
                                        <td><button class="btn btn-success" id="btnAgregarFilaHepatitisB"
                                            onclick="agregarFilaHepatitisB()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpanHepatitisB">1</span></td>
                                        <td><input type="date" id="fechaInputHepatitisB" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInputHepatitisB" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInputHepatitisB" placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputHepatitisB"
                                            placeholder="Responsable"></td>
                                        <td><input type="text" id="establecimientoInputHepatitisB"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputHepatitisB"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="influenza">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionInfluenza" aria-expanded="false"
                                  aria-controls="coleccionInfluenza">
                                  Influenza
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionInfluenza" class="collapse" aria-labelledby="Influenza"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- TABLA DE LA INFLUENZA -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableInfluenza">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowInfluenza">
                                        <td><button class="btn btn-success" id="btnAgregarFilaInfluenza"
                                            onclick="agregarFilaInfluenza()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpanInfluenza">1</span></td>
                                        <td><input type="date" id="fechaInputInfluenza" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInputInfluenza" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInputInfluenza" placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputInfluenza" placeholder="Responsable">
                                        </td>
                                        <td><input type="text" id="establecimientoInputInfluenza"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputInfluenza"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="fiebreAmarilla">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionFiebreAmarilla" aria-expanded="false"
                                  aria-controls="coleccionFiebreAmarilla">
                                  Fiebre Amarilla
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionFiebreAmarilla" class="collapse" aria-labelledby="FiebreAmarilla"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- TABLA DE LA DOSIS PARA FIEBRE AMARILLA -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableFiebreAmarilla">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowFiebreAmarilla">
                                        <td><button class="btn btn-success" id="btnAgregarFilaFiebreAmarilla"
                                            onclick="agregarFilaFiebreAmarilla()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpanFiebreAmarilla">1</span></td>
                                        <td><input type="date" id="fechaInputFiebreAmarilla" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInputFiebreAmarilla" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInputFiebreAmarilla"
                                            placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputFiebreAmarilla"
                                            placeholder="Responsable"></td>
                                        <td><input type="text" id="establecimientoInputFiebreAmarilla"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputFiebreAmarilla"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="sarampionRubeola">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionSarampionRubeola" aria-expanded="false"
                                  aria-controls="coleccionSarampionRubeola">
                                  Sarampión - Rubeola
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionSarampionRubeola" class="collapse" aria-labelledby="SarampionRubeola"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- TABLA PARA LA DOSIS DE SARAMPION -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableSarampion">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowSarampion">
                                        <td><button class="btn btn-success" id="btnAgregarFilaSarampion"
                                            onclick="agregarFilaSarampion()">Agregar</button>
                                        </td>
                                        <td><span id="dosisSpanSarampion">1</span></td>
                                        <td><input type="date" id="fechaInputSarampion" placeholder="Fecha"></td>
                                        <td><input type="number" id="loteInputSarampion" placeholder="Lote"></td>
                                        <td><input type="checkbox" id="esquemaInputSarampion" placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputSarampion" placeholder="Responsable">
                                        </td>
                                        <td><input type="text" id="establecimientoInputSarampion"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputSarampion"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="card">
                            <div class="card-header" id="vacunasAdicionales">
                              <h2 class="mb-0">
                                <button class="btn btn-link btn-block text-left collapsed" type="button"
                                  data-toggle="collapse" data-target="#coleccionVacunasAdicionales"
                                  aria-expanded="false" aria-controls="coleccionVacunasAdicionales">
                                  Vacunas Adicionales
                                </button>
                              </h2>
                            </div>
                            <div id="coleccionVacunasAdicionales" class="collapse" aria-labelledby="VacunasAdicionales"
                              data-parent="#accordionListInmunizaciones">
                              <div class="card-body">
                                <!-- TABLA PARA LA DOSIS DE VACUNAS ADICIONALES -->
                                <div class="table-responsive">
                                  <table class="table table-primary" id="tableVacunasAdicionales">
                                    <thead>
                                      <tr>
                                        <th scope="col">Acciones</th>
                                        <th scope="col">Nombre de la Vacuna</th>
                                        <th scope="col">Dosis</th>
                                        <th scope="col">Fecha</th>
                                        <th scope="col">Lote</th>
                                        <th scope="col">Esquema Completo</th>
                                        <th scope="col">Responsable de la Vacuna</th>
                                        <th scope="col">Establecimiento de Salud donde se colocó la Vacuna</th>
                                        <th scope="col">Observaciones</th>
                                      </tr>
                                    </thead>
                                    <tbody>
                                      <tr id="newRowVacunasAdicionales">
                                        <td><button class="btn btn-success" id="btnAgregarFilaVacunasAdicionales"
                                            onclick="agregarFilaVacunasAdicionales()">Agregar</button>
                                        </td>
                                        <td><input type="text" id="nombreVacunaAdicionalInput"
                                            placeholder="Nombre de la Vacuna"></td>
                                        <td><span id="dosisSpanVacunasAdicionales">1</span></td>
                                        <td><input type="date" id="fechaInputVacunasAdicionales" placeholder="Fecha">
                                        </td>
                                        <td><input type="number" id="loteInputVacunasAdicionales" placeholder="Lote">
                                        </td>
                                        <td><input type="checkbox" id="esquemaInputVacunasAdicionales"
                                            placeholder="Esquema">
                                        </td>
                                        <td><input type="text" id="responsableInputVacunasAdicionales"
                                            placeholder="Responsable"></td>
                                        <td><input type="text" id="establecimientoInputVacunasAdicionales"
                                            placeholder="Establecimiento">
                                        </td>
                                        <td><input type="text" id="observacionesInputVacunasAdicionales"
                                            placeholder="Observaciones"></td>
                                      </tr>
                                    </tbody>
                                  </table>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    <button type="button" class="btn btn-secondary prev-button" data-toggle="pill"
                      href="#paso1">Anterior</button>
                    <button type="button" class="btn btn-primary next-button" data-toggle="pill"
                      href="#paso3">Siguiente</button>
                  </div>
                  <!-- Paso 3 -->
                  <div class="tab-pane fade" id="paso3">
                    <br>
                    <h4>Paso 3</h4>
                    <form>
                      <div class="form-group">
                        <label for="edad">Edad:</label>
                        <input type="number" class="form-control" id="edad" placeholder="Ingrese su edad">
                      </div>
                      <button type="button" class="btn btn-secondary prev-button" data-toggle="pill"
                        href="#paso2">Anterior</button>
                      <button type="button" class="btn btn-primary next-button" data-toggle="pill"
                        href="#paso4">Siguiente</button>
                    </form>
                  </div>
                  <!-- Paso 4 -->
                  <div class="tab-pane fade" id="paso4">
                    <br>
                    <h4>Paso 4</h4>
                    <form>
                      <div class="form-group">
                        <label for="correo">Correo:</label>
                        <input type="email" class="form-control" id="correo" placeholder="Ingrese su correo">
                      </div>
                      <button type="button" class="btn btn-secondary prev-button" data-toggle="pill"
                        href="#paso3">Anterior</button>
                      <button type="submit" class="btn btn-success">Enviar</button>
                    </form>
                  </div>
                </div>

              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
            <button id="btnGrabar" type="button" class="btn btn-secondary">Grabar</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>


<script>
  // Agregar funcionalidad para cambiar de pestaña al hacer clic en el botón "Siguiente"
  $(document).ready(function () {
    $('.next-button').on('click', function () {
      var nextTab = $(this).attr('href');
      $('.nav-pills a[href="' + nextTab + '"]').tab('show');
    });

    // Agregar funcionalidad para cambiar de pestaña al hacer clic en el botón "Anterior"
    $('.prev-button').on('click', function () {
      var prevTab = $(this).attr('href');
      $('.nav-pills a[href="' + prevTab + '"]').tab('show');
    });

    $('.paso-tab').on('click', function () {
      var targetTab = $(this).attr('href');
      $('.nav-pills a[href="' + targetTab + '"]').tab('show');
    });
  });

  function seleccionarOpcion() {
    var codprovcli = $('#codigo_paciente').val();

    if (codprovcli) {
      $.ajax({
        type: 'GET',
        url: '{% url "obtener_datos_paciente" %}',
        data: { 'codprovcli': codprovcli },
        success: function (data) {
          if (data.error) {
            alert(data.error);
          } else {
            var tabla = $('#miTabla tbody');
            tabla.empty();

            for (var i = 0; i < data.data.length; i++) {
              var paciente = data.data[i];
              var row = '<tr>';
              row += '<td class="text-sm">' + paciente.codprovcli + '</td>';
              row += '<td class="text-sm">' + paciente.historia + '</td>';
              row += '<td class="text-sm">' + paciente.ruc + '</td>';
              row += '<td class="text-sm">' + paciente.nombre + '</td>';
              row += '<td class="text-sm">' + paciente.direccion + '</td>';
              row += '<td class="text-sm">' + paciente.telefono + '</td>';
              if (paciente.bandactivo) {
                row += '<td><button class="btn btn-outline-secondary" onclick="capturarCodProvCli(\'' + paciente.codprovcli + '\', \'' + paciente.nombre + '\')">Activo</button></td>';
              } else {
                row += '<td><button class="btn btn-outline-secondary"  id="nazi" onclick="capturarCodProvCli(\'' + paciente.codprovcli + '\', \'' + paciente.nombre + '\')" disabled>Inactivo</button></td>';
              };
              row += '</tr>';
              tabla.append(row);
            }

            $('#tabSeleccion').removeClass('active');
            $('#tabTabla').addClass('active');
            $('#seleccion').removeClass('show active');
            $('#miTabla').addClass('show active');
          }
        },
        error: function () {
          alert('Error al obtener los datos del paciente');
        }
      });
    } else {
      alert('Por favor, selecciona un paciente.');
    }
  }

  function volverASeleccion() {
    $('#miTabla tbody').empty();
    $('#codigo_paciente').val('').trigger('change');
    $('#tabTabla').removeClass('active');
    $('#tabSeleccion').addClass('active');
    $('#miTabla').removeClass('show active');
    $('#seleccion').addClass('show active');
  }

  // Nueva función para capturar el valor y mostrarlo en la consola
  function capturarCodProvCli(codprovcli, paciente) {
    // Muestra los detalles en el modal
    $('#modalInfoPaciente').modal('show');

  }

</script>


<script>
  var empresa = {};
  // Nueva función para enviar datos usando Ajax
  function enviarDatos(empresa) {
    // Limpiar la variable datosFilas
    var datosFilas = '';
    console.log('datosFilas', datosFilas)
    // Actualiza el valor de vacuna_tetano
    var hayDatosEnTabla = datosTetanos.length > 0;
    var vacuna_tetano = hayDatosEnTabla ? 'Recibida' : '';
    // Guarda los datos de las filas
    var datosFilas = hayDatosEnTabla ? JSON.stringify(datosTetanos) : '';  //Utiliza una cadena vacía si no hay registros
    if (hayDatosEnTabla) {
      // Reinicia el array de datosTetanos solo si hay datos en la tabla
      datosTetanos = [];
    }

<<<<<<< HEAD
=======
    var datosFilasHepatitis = '';
    console.log('datosFilasHepatitis', datosFilasHepatitis);
    // Actualiza el valor de vacuna_hepatitis
    var hayDatosEnTablaHepatitis = datosHepatitis.length > 0;
    var vacuna_hepatitis = hayDatosEnTablaHepatitis ? 'Recibida' : '';
    // Guarda los datos de las filas de Hepatitis
    var datosFilasHepatitis = hayDatosEnTablaHepatitis ? JSON.stringify(datosHepatitis) : '';  // Utiliza una cadena vacía si no hay registros
    console.log(datosFilasHepatitis)
    if (hayDatosEnTablaHepatitis) {
        // Reinicia el array de datosHepatitis solo si hay datos en la tabla
        datosHepatitis = [];
    }
    
>>>>>>> 43becf990aa4f8fccfe37a87f8d904505f7ec9de
    $.ajax({
      type: 'GET',
      url: '{% url "tu_vista_de_impresion" %}',
      data: {
        'nombre_empresa_vacuna': empresa.Nombreempresa,
        'ruc': empresa.Ruc,
        'historiaclinica': empresa.HistoriaClinica,
        'primerapellido': empresa.PrimerApellido,
        'segundoapellido': empresa.SegundoApellido,
        'primernombre': empresa.PrimerNombre,
        'segundonombre': empresa.SegundoNombre,
        'sexo': empresa.Sexo,
        'ocupacion': empresa.Ocupacion,
        'vacuna_tetano': vacuna_tetano,
        'vacuna_hepatitis' : vacuna_hepatitis,
        'datos_filas': datosFilas,
        'datos_filas_hepatitis': datosFilasHepatitis

        // Puedes agregar más datos si es necesario
      },
      success: function (response) {
        console.log(response);
        toastr.success('Insert a Vacunacion exitoso.', 'Éxito', {
          progressBar: true,
          closeDuration: 25,
          "positionClass": "toast-top-left",
        }); // Maneja la respuesta del servidor
      },
      error: function (error) {
        console.error('Error en la solicitud Ajax:', error);
      }
    });


    // Limpia los campos dentro de la tabla después de grabar
    limpiarCamposTabla();
    limpiarCamposTablaHepatitis();


  }

  // Función para limpiar campos dentro de la tabla
  function limpiarCamposTabla() {
    const tbody = document.getElementById('tableTetanos').getElementsByTagName('tbody')[0];
    const filas = tbody.getElementsByTagName('tr');

    // Itera sobre todas las filas excepto la primera
    for (let i = filas.length - 1; i > 0; i--) {
      tbody.removeChild(filas[i]);
    }

    // Reinicia el contador de dosis
    contadorDosis = 1;

    // Actualiza el contenido de la celda de dosis en la primera fila con los inputs
    const dosisSpan = document.getElementById('dosisSpan');
    dosisSpan.textContent = contadorDosis;

    // Habilita el botón de agregar
    document.getElementById('btnAgregarFilaTetanos').disabled = false;
  }

    // Función para limpiar campos dentro de la tabla Hepatitis
  function limpiarCamposTablaHepatitis() {
      const tbodyHepatitis = document.getElementById('tableHepatitisA').getElementsByTagName('tbody')[0];
      const filasHepatitis = tbodyHepatitis.getElementsByTagName('tr');
      // Itera sobre todas las filas excepto la primera
      for (let i = filasHepatitis.length - 1; i > 0; i--) {
          tbodyHepatitis.removeChild(filasHepatitis[i]);
      }
      // Reinicia el contador de dosis de Hepatitis
      contadorDosisHepatitis = 1;
      // Actualiza el contenido de la celda de dosis en la primera fila con los inputs de Hepatitis
      const dosisSpanHepatitis = document.getElementById('dosisSpanHepatitis');
      dosisSpanHepatitis.textContent = contadorDosisHepatitis;
      // Habilita el botón de agregar para Hepatitis
      document.getElementById('btnAgregarFilaHepatitis').disabled = false;
  }

  $(document).ready(function () {
    // DECLARACION DE LOS INPUTS PARA LLENAR
    const inputRucVacuna = document.getElementById('inputRucVacuna');
    const inputNombreEmpresaVacuna = document.getElementById('inputNombreEmpresaVacuna');
    const inputNumHistoriaClinicaVacuna = document.getElementById('inputNumHistoriaClinicaVacuna');
    const inputCargoOcupacionVacuna = document.getElementById('inputCargoOcupacionVacuna');
    const inputPrimerApellidoVacuna = document.getElementById('inputPrimerApellidoVacuna');
    const inputSegundoApellidoVacuna = document.getElementById('inputSegundoApellidoVacuna');
    const inputPrimerNombreVacuna = document.getElementById('inputPrimerNombreVacuna');
    const inputSegundoNombreVacuna = document.getElementById('inputSegundoNombreVacuna');
    const inputSexoVacuna = document.getElementById('inputSexoVacuna');
    const inputNumArchivoVacuna = document.getElementById('inputNumArchivoVacuna');

    // Agregar evento al modal cuando se muestra
    $('#modalInfoPaciente').on('shown.bs.modal', function () {
      inputRucVacuna.value = '';
      inputNombreEmpresaVacuna.value = '';
      inputNumHistoriaClinicaVacuna.value = '';
      inputCargoOcupacionVacuna.value = '';
      inputPrimerApellidoVacuna.value = '';
      inputSegundoApellidoVacuna.value = '';
      inputPrimerNombreVacuna.value = '';
      inputSegundoNombreVacuna.value = '';
      inputNumArchivoVacuna.value = '';

      Swal.fire({
        position: "top-end",
        icon: "info",
        title: "Cargando información ...",
        showConfirmButton: false,
      });

      var codprovcli = $('#codigo_paciente').val();

      // Verifica si hay un valor de codprovcli antes de realizar la solicitud AJAX
      if (codprovcli) {
        // Construye la URL completa con el parámetro codprovcli
        var url = `/empresa/Hormi2023/fichasii4?codprovcli=${codprovcli}`;

        // Realiza la solicitud AJAX para obtener los detalles del paciente
        $.ajax({
          type: 'GET',
          url: url,
          success: function (data) {
            if (data.error) {
              Swal.fire({
                position: "top-end",
                icon: "error",
                title: `${data.error}`,
                showConfirmButton: false,
              });
            } else {
              Swal.close();
              // LLENAR INPUT CON DATA

              let empresa = data.empresa;
              inputRucVacuna.value = empresa.Ruc
              inputNombreEmpresaVacuna.value = empresa.Nombreempresa
              inputNumHistoriaClinicaVacuna.value = empresa.HistoriaClinica
              inputCargoOcupacionVacuna.value = empresa.Ocupacion
              inputPrimerApellidoVacuna.value = empresa.PrimerApellido;
              inputSegundoApellidoVacuna.value = empresa.SegundoApellido;
              inputPrimerNombreVacuna.value = empresa.PrimerNombre;
              inputSegundoNombreVacuna.value = empresa.SegundoNombre;
              inputSexoVacuna.value = empresa.Sexo;
              inputNumArchivoVacuna.value = empresa.NumeroArchivo;
              // DATOS LLENOS
              Swal.fire({
                position: "top-end",
                icon: "success",
                title: `Datos llenos correctamente`,
                showConfirmButton: false,
                timer: 1000,
              });


              $('#btnGrabar').on('click', function () {
                if (datosTetanos.length > 0) {
                  // Actualiza la variable 'empresa' con los datos del paciente
                  empresa = {
                    'Nombreempresa': inputNombreEmpresaVacuna.value,
                    'Ruc': inputRucVacuna.value,
                    'HistoriaClinica': inputNumHistoriaClinicaVacuna.value,
                    'PrimerApellido': inputPrimerApellidoVacuna.value,
                    'SegundoApellido': inputSegundoApellidoVacuna.value,
                    'PrimerNombre': inputPrimerNombreVacuna.value,
                    'SegundoNombre': inputSegundoNombreVacuna.value,
                    'Sexo': inputSexoVacuna.value,
                    'Ocupacion': inputCargoOcupacionVacuna.value
                    // Agrega más campos según sea necesario
                  };

                  // Enviar el valor a la vista usando Ajax
                  enviarDatos(empresa);
                  empresa = {}; // Puedes reiniciar la variable 'empresa' si es necesario
                }
                if (datosHepatitis.length > 0) {
                  // Actualiza la variable 'empresa' con los datos del paciente
                  empresa = {
                    'Nombreempresa': inputNombreEmpresaVacuna.value,
                    'Ruc': inputRucVacuna.value,
                    'HistoriaClinica': inputNumHistoriaClinicaVacuna.value,
                    'PrimerApellido': inputPrimerApellidoVacuna.value,
                    'SegundoApellido': inputSegundoApellidoVacuna.value,
                    'PrimerNombre': inputPrimerNombreVacuna.value,
                    'SegundoNombre': inputSegundoNombreVacuna.value,
                    'Sexo': inputSexoVacuna.value,
                    'Ocupacion': inputCargoOcupacionVacuna.value
                    // Agrega más campos según sea necesario
                  };
                  // Enviar el valor a la vista usando Ajax
                  enviarDatos(empresa);
                  empresa = {}; // Puedes reiniciar la variable 'empresa' si es necesario
                }

              });
            }
          },
          error: function () {
            alert('Error al obtener los detalles del paciente');
          }
        });
      }
    });
  });

</script>

<!-- CODIGO PARA LA FUNCIONALIDAD DE LA TABLA -->
<script>
  let datosTetanos = [];
  let datosHepatitis = [];
  let datosHepatitisB = [];
  let datosInfluenza = [];
  let datosFiebreAmarilla = [];
  let datosSarampion = [];
  let datosVacunasAdicionales = [];

  var contadorDosis = 1;
  var contadorDosisHepatitis = 1;
  var contadorDosisHepatitisB = 1;
  var contadorDosisInfluenza = 1;
  var contadorDosisFiebreAmarilla = 1;
  var contadorDosisSarampion = 1;
  var contadorDosisVacunasAdicionales = 1;

  const inputObservaciones = document.getElementById('observacionesInput');
  const inputObservacionesHepatitis = document.getElementById('observacionesInputHepatitis')
  const inputObservacionesHepatitisB = document.getElementById('observacionesInputHepatitisB')
  const inputObservacionesInfluenza = document.getElementById('observacionesInputInfluenza')
  const inputObservacionesFiebreAmarilla = document.getElementById('observacionesInputFiebreAmarilla');
  const inputObservacionesSarampion = document.getElementById('observacionesInputSarampion');
  const observacionesInputVacunasAdicionales = document.getElementById('observacionesInputVacunasAdicionales');
  // Restablecer los valores de la tabla

  function agregarFila() {
    // Obtén los valores de los campos de entrada
    const fecha = document.getElementById('fechaInput').value;
    const lote = document.getElementById('loteInput').value;
    const esquema = document.getElementById('esquemaInput').checked;
    const responsable = document.getElementById('responsableInput').value;
    const establecimiento = document.getElementById('establecimientoInput').value;
    const observaciones = document.getElementById('observacionesInput').value;
    const dosisSpan = document.getElementById('dosisSpan');
    const btnAgregarFilaTetanos = document.getElementById('btnAgregarFilaTetanos');
    var hayDatosEnTabla = datosTetanos.length > 0;
    var vacuna_tetano = hayDatosEnTabla ? 'Recibida' : '';

    if (fecha, lote, responsable, establecimiento != '') {
      var nuevaFila = {
        dosis: contadorDosis,
        fecha: fecha,
        lote: lote,
        esquema: esquema,
        responsable: responsable,
        establecimiento: establecimiento,
        observaciones: observaciones
      };
      datosTetanos.push(nuevaFila);
      // Obtén el cuerpo de la tabla
      const tbody = document.getElementById('tableTetanos').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRow = tbody.insertRow();
      // Agrega celdas a la nueva fila
      const cell1 = newRow.insertCell(0);
      const cell2 = newRow.insertCell(1);
      const cell3 = newRow.insertCell(2);
      const cell4 = newRow.insertCell(3);
      const cell5 = newRow.insertCell(4);
      const cell6 = newRow.insertCell(5);
      const cell7 = newRow.insertCell(6);
      const cell8 = newRow.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1.innerHTML = '+';
      cell2.innerHTML = contadorDosis;
      cell3.innerHTML = fecha;
      cell4.innerHTML = lote;
      cell5.innerHTML = esquema ? 'Sí' : 'No';
      cell6.innerHTML = responsable;
      cell7.innerHTML = establecimiento;
      cell8.innerHTML = observaciones;
      // Incrementar el contador de dosis
      contadorDosis++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpan.value = contadorDosis;
      dosisSpan.textContent = contadorDosis;
      document.getElementById('fechaInput').value = '';
      document.getElementById('loteInput').value = '';
      document.getElementById('esquemaInput').checked = false;
      document.getElementById('responsableInput').value = '';
      document.getElementById('establecimientoInput').value = '';
      document.getElementById('observacionesInput').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosis > 5) {
        btnAgregarFilaTetanos.disabled = true;
        document.getElementById('fechaInput').disabled = true;
        document.getElementById('loteInput').disabled = true;
        document.getElementById('responsableInput').disabled = true;
        document.getElementById('esquemaInput').disabled = true;
        document.getElementById('establecimientoInput').disabled = true;
        document.getElementById('observacionesInput').disabled = true;

      }

    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaHepatitis() {
    // Obtén los valores de los campos de entrada
    const fechaHepatitis = document.getElementById('fechaInputHepatitis').value;
    const loteHepatitis = document.getElementById('loteInputHepatitis').value;
    const esquemaHepatitis = document.getElementById('esquemaInputHepatitis').checked;
    const responsableHepatitis = document.getElementById('responsableInputHepatitis').value;
    const establecimientoHepatitis = document.getElementById('establecimientoInputHepatitis').value;
    const observacionesHepatitis = document.getElementById('observacionesInputHepatitis').value;
    const dosisSpanHepatitis = document.getElementById('dosisSpanHepatitis');
    const btnAgregarFilaHepatitis = document.getElementById('btnAgregarFilaHepatitis');
    var hayDatosEnTabla = datosHepatitis.length > 0;
    var vacuna_hepatitis = hayDatosEnTabla ? 'Recibida' : '';

    if (fechaHepatitis, loteHepatitis, responsableHepatitis, establecimientoHepatitis != '') {
      var nuevaFilaHepatitis = {
        dosis: contadorDosisHepatitis,
        fecha: fechaHepatitis,
        lote: loteHepatitis,
        esquema: esquemaHepatitis,
        responsable: responsableHepatitis,
        establecimiento: establecimientoHepatitis,
        observaciones: observacionesHepatitis
      };
      datosHepatitis.push(nuevaFilaHepatitis);
      // Obtén el cuerpo de la tabla
      const tbodyHepatitis = document.getElementById('tableHepatitisA').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowHepatitis = tbodyHepatitis.insertRow();
      // Agrega celdas a la nueva fila
      const cell1Hepatitis = newRowHepatitis.insertCell(0);
      const cell2Hepatitis = newRowHepatitis.insertCell(1);
      const cell3Hepatitis = newRowHepatitis.insertCell(2);
      const cell4Hepatitis = newRowHepatitis.insertCell(3);
      const cell5Hepatitis = newRowHepatitis.insertCell(4);
      const cell6Hepatitis = newRowHepatitis.insertCell(5);
      const cell7Hepatitis = newRowHepatitis.insertCell(6);
      const cell8Hepatitis = newRowHepatitis.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1Hepatitis.innerHTML = '+';
      cell2Hepatitis.innerHTML = contadorDosisHepatitis;
      cell3Hepatitis.innerHTML = fechaHepatitis;
      cell4Hepatitis.innerHTML = loteHepatitis;
      cell5Hepatitis.innerHTML = esquemaHepatitis ? 'Sí' : 'No';
      cell6Hepatitis.innerHTML = responsableHepatitis;
      cell7Hepatitis.innerHTML = establecimientoHepatitis;
      cell8Hepatitis.innerHTML = observacionesHepatitis;
      // Incrementar el contador de dosis
      contadorDosisHepatitis++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpanHepatitis.value = contadorDosisHepatitis;
      dosisSpanHepatitis.textContent = contadorDosisHepatitis;
      document.getElementById('fechaInputHepatitis').value = '';
      document.getElementById('loteInputHepatitis').value = '';
      document.getElementById('esquemaInputHepatitis').checked = false;
      document.getElementById('responsableInputHepatitis').value = '';
      document.getElementById('establecimientoInputHepatitis').value = '';
      document.getElementById('observacionesInputHepatitis').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisHepatitis > 3) {
        btnAgregarFilaHepatitis.disabled = true;
        document.getElementById('fechaInputHepatitis').disabled = true;
        document.getElementById('loteInputHepatitis').disabled = true;
        document.getElementById('responsableInputHepatitis').disabled = true;
        document.getElementById('esquemaInputHepatitis').disabled = true;
        document.getElementById('establecimientoInputHepatitis').disabled = true;
        document.getElementById('observacionesInputHepatitis').disabled = true;
      }

    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaHepatitisB() {
    // Obtén los valores de los campos de entrada
    const fechaHepatitisB = document.getElementById('fechaInputHepatitisB').value;
    const loteHepatitisB = document.getElementById('loteInputHepatitisB').value;
    const esquemaHepatitisB = document.getElementById('esquemaInputHepatitisB').checked;
    const responsableHepatitisB = document.getElementById('responsableInputHepatitisB').value;
    const establecimientoHepatitisB = document.getElementById('establecimientoInputHepatitisB').value;
    const observacionesHepatitisB = document.getElementById('observacionesInputHepatitisB').value;
    const dosisSpanHepatitisB = document.getElementById('dosisSpanHepatitisB');
    const btnAgregarFilaHepatitisB = document.getElementById('btnAgregarFilaHepatitisB');
    var hayDatosEnTabla = datosHepatitisB.length > 0;
    var vacuna_hepatitisB = hayDatosEnTabla ? 'Recibida' : '';

    if (fechaHepatitisB, loteHepatitisB, responsableHepatitisB, establecimientoHepatitisB != '') {
      var nuevaFilaHepatitisB = {
        dosis: contadorDosisHepatitisB,
        fecha: fechaHepatitisB,
        lote: loteHepatitisB,
        esquema: esquemaHepatitisB,
        responsable: responsableHepatitisB,
        establecimiento: establecimientoHepatitisB,
        observaciones: observacionesHepatitisB
      };
      datosHepatitisB.push(nuevaFilaHepatitisB);
      // Obtén el cuerpo de la tabla
      const tbodyHepatitisB = document.getElementById('tableHepatitisB').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowHepatitisB = tbodyHepatitisB.insertRow();
      // Agrega celdas a la nueva fila
      const cell1HepatitisB = newRowHepatitisB.insertCell(0);
      const cell2HepatitisB = newRowHepatitisB.insertCell(1);
      const cell3HepatitisB = newRowHepatitisB.insertCell(2);
      const cell4HepatitisB = newRowHepatitisB.insertCell(3);
      const cell5HepatitisB = newRowHepatitisB.insertCell(4);
      const cell6HepatitisB = newRowHepatitisB.insertCell(5);
      const cell7HepatitisB = newRowHepatitisB.insertCell(6);
      const cell8HepatitisB = newRowHepatitisB.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1HepatitisB.innerHTML = '+';
      cell2HepatitisB.innerHTML = contadorDosisHepatitisB;
      cell3HepatitisB.innerHTML = fechaHepatitisB;
      cell4HepatitisB.innerHTML = loteHepatitisB;
      cell5HepatitisB.innerHTML = esquemaHepatitisB ? 'Sí' : 'No';
      cell6HepatitisB.innerHTML = responsableHepatitisB;
      cell7HepatitisB.innerHTML = establecimientoHepatitisB;
      cell8HepatitisB.innerHTML = observacionesHepatitisB;
      // Incrementar el contador de dosis
      contadorDosisHepatitisB++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpanHepatitisB.value = contadorDosisHepatitisB;
      dosisSpanHepatitisB.textContent = contadorDosisHepatitisB;
      document.getElementById('fechaInputHepatitisB').value = '';
      document.getElementById('loteInputHepatitisB').value = '';
      document.getElementById('esquemaInputHepatitisB').checked = false;
      document.getElementById('responsableInputHepatitisB').value = '';
      document.getElementById('establecimientoInputHepatitisB').value = '';
      document.getElementById('observacionesInputHepatitisB').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisHepatitisB > 3) {
        btnAgregarFilaHepatitisB.disabled = true;
        document.getElementById('fechaInputHepatitisB').disabled = true;
        document.getElementById('loteInputHepatitisB').disabled = true;
        document.getElementById('responsableInputHepatitisB').disabled = true;
        document.getElementById('esquemaInputHepatitisB').disabled = true;
        document.getElementById('establecimientoInputHepatitisB').disabled = true;
        document.getElementById('observacionesInputHepatitisB').disabled = true;
      }

    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaInfluenza() {
    // Obtén los valores de los campos de entrada
    const fechaInfluenza = document.getElementById('fechaInputInfluenza').value;
    const loteInfluenza = document.getElementById('loteInputInfluenza').value;
    const esquemaInfluenza = document.getElementById('esquemaInputInfluenza').checked;
    const responsableInfluenza = document.getElementById('responsableInputInfluenza').value;
    const establecimientoInfluenza = document.getElementById('establecimientoInputInfluenza').value;
    const observacionesInfluenza = document.getElementById('observacionesInputInfluenza').value;
    const dosisSpanInfluenza = document.getElementById('dosisSpanInfluenza');
    const btnAgregarFilaInfluenza = document.getElementById('btnAgregarFilaInfluenza');
    var hayDatosEnTabla = datosInfluenza.length > 0;
    var vacuna_Influenza = hayDatosEnTabla ? 'Recibida' : '';

    if (fechaInfluenza, loteInfluenza, responsableInfluenza, establecimientoInfluenza != '') {
      var nuevaFilaInfluenza = {
        dosis: contadorDosisInfluenza,
        fecha: fechaInfluenza,
        lote: loteInfluenza,
        esquema: esquemaInfluenza,
        responsable: responsableInfluenza,
        establecimiento: establecimientoInfluenza,
        observaciones: observacionesInfluenza
      };
      datosInfluenza.push(nuevaFilaInfluenza);
      // Obtén el cuerpo de la tabla
      const tbodyInfluenza = document.getElementById('tableInfluenza').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowInfluenza = tbodyInfluenza.insertRow();
      // Agrega celdas a la nueva fila
      const cell1Influenza = newRowInfluenza.insertCell(0);
      const cell2Influenza = newRowInfluenza.insertCell(1);
      const cell3Influenza = newRowInfluenza.insertCell(2);
      const cell4Influenza = newRowInfluenza.insertCell(3);
      const cell5Influenza = newRowInfluenza.insertCell(4);
      const cell6Influenza = newRowInfluenza.insertCell(5);
      const cell7Influenza = newRowInfluenza.insertCell(6);
      const cell8Influenza = newRowInfluenza.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1Influenza.innerHTML = '+';
      cell2Influenza.innerHTML = contadorDosisInfluenza;
      cell3Influenza.innerHTML = fechaInfluenza;
      cell4Influenza.innerHTML = loteInfluenza;
      cell5Influenza.innerHTML = esquemaInfluenza ? 'Sí' : 'No';
      cell6Influenza.innerHTML = responsableInfluenza;
      cell7Influenza.innerHTML = establecimientoInfluenza;
      cell8Influenza.innerHTML = observacionesInfluenza;
      // Incrementar el contador de dosis
      contadorDosisInfluenza++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpanInfluenza.value = contadorDosisInfluenza;
      dosisSpanInfluenza.textContent = contadorDosisInfluenza;
      document.getElementById('fechaInputInfluenza').value = '';
      document.getElementById('loteInputInfluenza').value = '';
      document.getElementById('esquemaInputInfluenza').checked = false;
      document.getElementById('responsableInputInfluenza').value = '';
      document.getElementById('establecimientoInputInfluenza').value = '';
      document.getElementById('observacionesInputInfluenza').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisInfluenza > 1) {
        btnAgregarFilaInfluenza.disabled = true;
        document.getElementById('fechaInputInfluenza').disabled = true;
        document.getElementById('loteInputInfluenza').disabled = true;
        document.getElementById('responsableInputInfluenza').disabled = true;
        document.getElementById('esquemaInputInfluenza').disabled = true;
        document.getElementById('establecimientoInputInfluenza').disabled = true;
        document.getElementById('observacionesInputInfluenza').disabled = true;
      }

    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaFiebreAmarilla() {
    // Obtén los valores de los campos de entrada
    const fechaFiebreAmarilla = document.getElementById('fechaInputFiebreAmarilla').value;
    const loteFiebreAmarilla = document.getElementById('loteInputFiebreAmarilla').value;
    const esquemaFiebreAmarilla = document.getElementById('esquemaInputFiebreAmarilla').checked;
    const responsableFiebreAmarilla = document.getElementById('responsableInputFiebreAmarilla').value;
    const establecimientoFiebreAmarilla = document.getElementById('establecimientoInputFiebreAmarilla').value;
    const observacionesFiebreAmarilla = document.getElementById('observacionesInputFiebreAmarilla').value;
    const dosisSpanFiebreAmarilla = document.getElementById('dosisSpanFiebreAmarilla');
    const btnAgregarFilaFiebreAmarilla = document.getElementById('btnAgregarFilaFiebreAmarilla');
    var hayDatosEnTabla = datosFiebreAmarilla.length > 0;
    var vacuna_FiebreAmarilla = hayDatosEnTabla ? 'Recibida' : '';

    if (fechaFiebreAmarilla, loteFiebreAmarilla, responsableFiebreAmarilla, establecimientoFiebreAmarilla != '') {
      var nuevaFilaFiebreAmarilla = {
        dosis: contadorDosisFiebreAmarilla,
        fecha: fechaFiebreAmarilla,
        lote: loteFiebreAmarilla,
        esquema: esquemaFiebreAmarilla,
        responsable: responsableFiebreAmarilla,
        establecimiento: establecimientoFiebreAmarilla,
        observaciones: observacionesFiebreAmarilla
      };
      datosFiebreAmarilla.push(nuevaFilaFiebreAmarilla);
      // Obtén el cuerpo de la tabla
      const tbodyFiebreAmarilla = document.getElementById('tableFiebreAmarilla').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowFiebreAmarilla = tbodyFiebreAmarilla.insertRow();
      // Agrega celdas a la nueva fila
      const cell1FiebreAmarilla = newRowFiebreAmarilla.insertCell(0);
      const cell2FiebreAmarilla = newRowFiebreAmarilla.insertCell(1);
      const cell3FiebreAmarilla = newRowFiebreAmarilla.insertCell(2);
      const cell4FiebreAmarilla = newRowFiebreAmarilla.insertCell(3);
      const cell5FiebreAmarilla = newRowFiebreAmarilla.insertCell(4);
      const cell6FiebreAmarilla = newRowFiebreAmarilla.insertCell(5);
      const cell7FiebreAmarilla = newRowFiebreAmarilla.insertCell(6);
      const cell8FiebreAmarilla = newRowFiebreAmarilla.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1FiebreAmarilla.innerHTML = '+';
      cell2FiebreAmarilla.innerHTML = contadorDosisFiebreAmarilla;
      cell3FiebreAmarilla.innerHTML = fechaFiebreAmarilla;
      cell4FiebreAmarilla.innerHTML = loteFiebreAmarilla;
      cell5FiebreAmarilla.innerHTML = esquemaFiebreAmarilla ? 'Sí' : 'No';
      cell6FiebreAmarilla.innerHTML = responsableFiebreAmarilla;
      cell7FiebreAmarilla.innerHTML = establecimientoFiebreAmarilla;
      cell8FiebreAmarilla.innerHTML = observacionesFiebreAmarilla;
      // Incrementar el contador de dosis
      contadorDosisFiebreAmarilla++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpanFiebreAmarilla.value = contadorDosisFiebreAmarilla;
      dosisSpanFiebreAmarilla.textContent = contadorDosisFiebreAmarilla;
      document.getElementById('fechaInputFiebreAmarilla').value = '';
      document.getElementById('loteInputFiebreAmarilla').value = '';
      document.getElementById('esquemaInputFiebreAmarilla').checked = false;
      document.getElementById('responsableInputFiebreAmarilla').value = '';
      document.getElementById('establecimientoInputFiebreAmarilla').value = '';
      document.getElementById('observacionesInputFiebreAmarilla').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisFiebreAmarilla > 1) {
        btnAgregarFilaFiebreAmarilla.disabled = true;
        document.getElementById('fechaInputFiebreAmarilla').disabled = true;
        document.getElementById('loteInputFiebreAmarilla').disabled = true;
        document.getElementById('responsableInputFiebreAmarilla').disabled = true;
        document.getElementById('esquemaInputFiebreAmarilla').disabled = true;
        document.getElementById('establecimientoInputFiebreAmarilla').disabled = true;
        document.getElementById('observacionesInputFiebreAmarilla').disabled = true;
      }
    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaSarampion() {
    // Obtén los valores de los campos de entrada
    const fechaSarampion = document.getElementById('fechaInputSarampion').value;
    const loteSarampion = document.getElementById('loteInputSarampion').value;
    const esquemaSarampion = document.getElementById('esquemaInputSarampion').checked;
    const responsableSarampion = document.getElementById('responsableInputSarampion').value;
    const establecimientoSarampion = document.getElementById('establecimientoInputSarampion').value;
    const observacionesSarampion = document.getElementById('observacionesInputSarampion').value;
    const dosisSpanSarampion = document.getElementById('dosisSpanSarampion');
    const btnAgregarFilaSarampion = document.getElementById('btnAgregarFilaSarampion');
    var hayDatosEnTabla = datosSarampion.length > 0;
    var vacuna_Sarampion = hayDatosEnTabla ? 'Recibida' : '';

    if (fechaSarampion, loteSarampion, responsableSarampion, establecimientoSarampion != '') {
      var nuevaFilaSarampion = {
        dosis: contadorDosisSarampion,
        fecha: fechaSarampion,
        lote: loteSarampion,
        esquema: esquemaSarampion,
        responsable: responsableSarampion,
        establecimiento: establecimientoSarampion,
        observaciones: observacionesSarampion
      };
      datosSarampion.push(nuevaFilaSarampion);
      // Obtén el cuerpo de la tabla
      const tbodySarampion = document.getElementById('tableSarampion').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowSarampion = tbodySarampion.insertRow();
      // Agrega celdas a la nueva fila
      const cell1Sarampion = newRowSarampion.insertCell(0);
      const cell2Sarampion = newRowSarampion.insertCell(1);
      const cell3Sarampion = newRowSarampion.insertCell(2);
      const cell4Sarampion = newRowSarampion.insertCell(3);
      const cell5Sarampion = newRowSarampion.insertCell(4);
      const cell6Sarampion = newRowSarampion.insertCell(5);
      const cell7Sarampion = newRowSarampion.insertCell(6);
      const cell8Sarampion = newRowSarampion.insertCell(7);
      // Llena las celdas con los valores de los campos de entrada
      cell1Sarampion.innerHTML = '+';
      cell2Sarampion.innerHTML = contadorDosisSarampion;
      cell3Sarampion.innerHTML = fechaSarampion;
      cell4Sarampion.innerHTML = loteSarampion;
      cell5Sarampion.innerHTML = esquemaSarampion ? 'Sí' : 'No';
      cell6Sarampion.innerHTML = responsableSarampion;
      cell7Sarampion.innerHTML = establecimientoSarampion;
      cell8Sarampion.innerHTML = observacionesSarampion;
      // Incrementar el contador de dosis
      contadorDosisSarampion++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      dosisSpanSarampion.value = contadorDosisSarampion;
      dosisSpanSarampion.textContent = contadorDosisSarampion;
      document.getElementById('fechaInputSarampion').value = '';
      document.getElementById('loteInputSarampion').value = '';
      document.getElementById('esquemaInputSarampion').checked = false;
      document.getElementById('responsableInputSarampion').value = '';
      document.getElementById('establecimientoInputSarampion').value = '';
      document.getElementById('observacionesInputSarampion').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisSarampion > 2) {
        btnAgregarFilaSarampion.disabled = true;
        document.getElementById('fechaInputSarampion').disabled = true;
        document.getElementById('loteInputSarampion').disabled = true;
        document.getElementById('responsableInputSarampion').disabled = true;
        document.getElementById('esquemaInputSarampion').disabled = true;
        document.getElementById('establecimientoInputSarampion').disabled = true;
        document.getElementById('observacionesInputSarampion').disabled = true;
      }

    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  function agregarFilaVacunasAdicionales() {
    // Obtén los valores de los campos de entrada
    const nombreVacunaAdicionalInput = document.getElementById('nombreVacunaAdicionalInput').value;
    const fechaVacunasAdicionales = document.getElementById('fechaInputVacunasAdicionales').value;
    const loteVacunasAdicionales = document.getElementById('loteInputVacunasAdicionales').value;
    const esquemaVacunasAdicionales = document.getElementById('esquemaInputVacunasAdicionales').checked;
    const responsableVacunasAdicionales = document.getElementById('responsableInputVacunasAdicionales').value;
    const establecimientoVacunasAdicionales = document.getElementById('establecimientoInputVacunasAdicionales').value;
    const observacionesVacunasAdicionales = document.getElementById('observacionesInputVacunasAdicionales').value;
    const dosisSpanVacunasAdicionales = document.getElementById('dosisSpanVacunasAdicionales');
    const btnAgregarFilaVacunasAdicionales = document.getElementById('btnAgregarFilaVacunasAdicionales');
    var hayDatosEnTabla = datosVacunasAdicionales.length > 0;
    var vacuna_VacunasAdicionales = hayDatosEnTabla ? 'Recibida' : '';

    if (nombreVacunaAdicionalInput, fechaVacunasAdicionales, loteVacunasAdicionales, responsableVacunasAdicionales, establecimientoVacunasAdicionales != '') {
      var nuevaFilaVacunasAdicionales = {
        nombreVacuna: nombreVacunaAdicionalInput,
        dosis: contadorDosisVacunasAdicionales,
        fecha: fechaVacunasAdicionales,
        lote: loteVacunasAdicionales,
        esquema: esquemaVacunasAdicionales,
        responsable: responsableVacunasAdicionales,
        establecimiento: establecimientoVacunasAdicionales,
        observaciones: observacionesVacunasAdicionales
      };
      datosVacunasAdicionales.push(nuevaFilaVacunasAdicionales);
      // Obtén el cuerpo de la tabla
      const tbodyVacunasAdicionales = document.getElementById('tableVacunasAdicionales').getElementsByTagName('tbody')[0];
      // Crea una nueva fila
      const newRowVacunasAdicionales = tbodyVacunasAdicionales.insertRow();
      // Agrega celdas a la nueva fila
      const cell1VacunasAdicionales = newRowVacunasAdicionales.insertCell(0);
      const cell2VacunasAdicionales = newRowVacunasAdicionales.insertCell(1);
      const cell3VacunasAdicionales = newRowVacunasAdicionales.insertCell(2);
      const cell4VacunasAdicionales = newRowVacunasAdicionales.insertCell(3);
      const cell5VacunasAdicionales = newRowVacunasAdicionales.insertCell(4);
      const cell6VacunasAdicionales = newRowVacunasAdicionales.insertCell(5);
      const cell7VacunasAdicionales = newRowVacunasAdicionales.insertCell(6);
      const cell8VacunasAdicionales = newRowVacunasAdicionales.insertCell(7);
      const cell9VacunasAdicionales = newRowVacunasAdicionales.insertCell(8);
      // Llena las celdas con los valores de los campos de entrada
      cell1VacunasAdicionales.innerHTML = '+';
      cell2VacunasAdicionales.innerHTML = nombreVacunaAdicionalInput;
      cell3VacunasAdicionales.innerHTML = contadorDosisVacunasAdicionales;
      cell4VacunasAdicionales.innerHTML = fechaVacunasAdicionales;
      cell5VacunasAdicionales.innerHTML = loteVacunasAdicionales;
      cell6VacunasAdicionales.innerHTML = esquemaVacunasAdicionales ? 'Sí' : 'No';
      cell7VacunasAdicionales.innerHTML = responsableVacunasAdicionales;
      cell8VacunasAdicionales.innerHTML = establecimientoVacunasAdicionales;
      cell9VacunasAdicionales.innerHTML = observacionesVacunasAdicionales;
      // Incrementar el contador de dosis
      contadorDosisVacunasAdicionales++;

      // Limpia o convierte los campos de entrada en etiquetas, según tu necesidad
      document.getElementById('nombreVacunaAdicionalInput').value = '';
      dosisSpanVacunasAdicionales.value = contadorDosisVacunasAdicionales;
      dosisSpanVacunasAdicionales.textContent = contadorDosisVacunasAdicionales;
      document.getElementById('fechaInputVacunasAdicionales').value = '';
      document.getElementById('loteInputVacunasAdicionales').value = '';
      document.getElementById('esquemaInputVacunasAdicionales').checked = false;
      document.getElementById('responsableInputVacunasAdicionales').value = '';
      document.getElementById('establecimientoInputVacunasAdicionales').value = '';
      document.getElementById('observacionesInputVacunasAdicionales').value = '';
      // Verificar si el contador de dosis llega a 5 y deshabilitar el botón
      if (contadorDosisVacunasAdicionales > 10) {
        document.getElementById('nombreVacunaAdicionalInput').disabled = true
        btnAgregarFilaVacunasAdicionales.disabled = true;
        document.getElementById('fechaInputVacunasAdicionales').disabled = true;
        document.getElementById('loteInputVacunasAdicionales').disabled = true;
        document.getElementById('responsableInputVacunasAdicionales').disabled = true;
        document.getElementById('esquemaInputVacunasAdicionales').disabled = true;
        document.getElementById('establecimientoInputVacunasAdicionales').disabled = true;
        document.getElementById('observacionesInputVacunasAdicionales').disabled = true;
      }
      console.log('Tetano', datosTetanos)
      console.log('Hepatitis A', datosHepatitis)
      console.log('Hepatitis B', datosHepatitisB)
      console.log('Influenza', datosInfluenza)
      console.log('Fiebre Amarilla', datosFiebreAmarilla)
      console.log('Sarampion', datosSarampion)
      console.log('Vacunas Adicionales', datosVacunasAdicionales)
    } else {
      Swal.fire({
        position: "top-end",
        icon: "error",
        title: "Por favor llene los datos necesarios!",
        showConfirmButton: false,
        timer: 2000
      });
    }
  }

  // FUNCIONAMIENTO DEL ENTER
  inputObservaciones.addEventListener('keydown', function () {
    if (event.key === 'Enter') {
      event.preventDefault();
      agregarFila();
    }
  })
  inputObservacionesHepatitis.addEventListener('keydown', function () {
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaHepatitis();
    }
  })
  inputObservacionesHepatitisB.addEventListener('keydown', function () {
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaHepatitisB();
    }
  })
  inputObservacionesInfluenza.addEventListener('keydown', function () {
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaInfluenza();
    }
  })
  inputObservacionesFiebreAmarilla.addEventListener('keydown', function () {
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaFiebreAmarilla();
    }
  })
  inputObservacionesSarampion.addEventListener('keydown', function () {
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaSarampion();
    }
  })
  observacionesInputVacunasAdicionales.addEventListener('keydown', function(){
    if (event.key == 'Enter') {
      event.preventDefault();
      agregarFilaSarampion();
    }
  })

</script>



{% endblock %}